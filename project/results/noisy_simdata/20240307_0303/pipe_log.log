=================================================================================
[2024-03-07 03:03] Starting  Pipeline...

=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching for time information...
Dates found in 'index' column!
Inferred frequency: month start
Data from goes from 2004-01-01 to 2013-12-01, resulting in 120 observations.

Selecting target and covariates...
Target: y
Covariates: x1, x2, x3

Data Insight:

                    y          x1         x2          x3
Date                                                    
2004-01-01  50.840469  427.595799  55.337904  900.325291
2004-02-01  52.871538  434.062163  54.959155  900.775888
2004-03-01  53.769316  453.264284  56.470633  899.510058
2004-04-01  57.672973  459.367523  56.704233  903.524834
2004-05-01  57.182051  462.354356  61.557907  905.071762
[Time elapsed: 00s]


=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data (train/test ratio: 30/70)...
Initial training set has 36 observations and goes from 2004-01-01 to 2006-12-01.
There are 84 periods to be forecasted: 2007-01-01 to 2013-12-01

Now generating 84 one-step ahead expanding window predictions from model: Naive (sktime)
...finished!

Now generating 84 one-step ahead expanding window predictions from model: Naive (drift) (sktime)
...finished!

Now generating 84 one-step ahead expanding window predictions from model: AutoSARIMA (sktime)
Auto-fitting model. Refitting every 28th period.
AutoSARIMA forecast 1 / 84
AutoSARIMA forecast 17 / 84
AutoSARIMA forecast 34 / 84
AutoSARIMA forecast 51 / 84
AutoSARIMA forecast 68 / 84
AutoSARIMA forecast 84 / 84
...finished!

Now generating 84 one-step ahead expanding window predictions from model: Exponential Smoothing (sktime)
...finished!

Now generating 84 one-step ahead expanding window predictions from model: STL (sktime)
...finished!

Now generating 84 one-step ahead expanding window predictions from model: XGBoost (darts)
...finished!

Now generating 84 one-step ahead expanding window predictions from model: XGBoost with covariates (darts)
...finished!


Individual forecasters' predictions finished!

Insights into forecasters' predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2007-01  48.857243      48.800580   49.606623              49.016606   
2007-02  48.254157      48.182315   48.515764              48.500499   
2007-03  47.765006      47.681886   47.973535              48.001824   
2007-04  46.394433      46.277432   46.969779              46.904911   
2007-05  44.212976      44.043041   45.108821              45.025232   

               STL    XGBoost  XGBoost with covariates  
Date                                                    
2007-01  40.574201  48.632446                49.624989  
2007-02  41.374739  50.458118                49.453224  
2007-03  45.653502  47.823650                48.497398  
2007-04  41.569708  47.594688                48.059471  
2007-05  49.855823  48.784794                45.706074  


Exporting individual predictions to csv file...
...finished!

[Time elapsed: 57s]


====================================================
== Pipeline Step 3: Ensemble Models' Predictions ==
====================================================

Splitting forecast data (n = 84) for ensemble forecasts (train/test ratio: 25/75)...
Initial training set has 21 observations and goes from 2007-01 to 2008-09
There are 63 periods to be forecasted by the individual models 2008-10 to 2013-12

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Weighted - Simple'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Weighted - Inverse RMSE'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Weighted - Inverse Variance'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Weighted - Inverse Error Covariance'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Meta - SVR (sklearn)'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Meta - Ridge (sklearn)'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Meta - Linear Regression (sklearn)'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Meta - MLP (sklearn)'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Now generating 63 one-step ahead expanding window predictions from ensemble model: 'Meta - RandomForest (sklearn)'
Ensemble forecast 1 / 63
Ensemble forecast 13 / 63
Ensemble forecast 26 / 63
Ensemble forecast 38 / 63
Ensemble forecast 51 / 63
Ensemble forecast 63 / 63
...finished!

Ensemble predictions finished!

Insights into ensembles' predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
2008-10                  58.005342                        58.338293   
2008-11                  58.081381                        57.641110   
2008-12                  58.691317                        58.591677   
2009-01                  60.397148                        60.517525   
2009-02                  61.113299                        60.814867   

         Weighted Ensemble: Inverse Variance  \
2008-10                            57.729481   
2008-11                            58.429848   
2008-12                            58.537898   
2009-01                            60.000398   
2009-02                            60.891558   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
2008-10                                    59.429356           62.201439   
2008-11                                    59.823373           61.395111   
2008-12                                    59.109602           60.441724   
2009-01                                    63.167688           63.756406   
2009-02                                    63.054764           64.408891   

         Meta Ensemble: Ridge  Meta Ensemble: Linear Regression  \
2008-10             60.966560                         57.055146   
2008-11             58.693008                         62.008223   
2008-12             60.361155                         58.875037   
2009-01             63.877170                         60.134848   
2009-02             62.597588                         59.901068   

         Meta Ensemble: MLP  Meta Ensemble: RandomForest  
2008-10           76.763095                    58.307169  
2008-11           66.517875                    57.801584  
2008-12           62.299776                    57.763094  
2009-01           74.890103                    60.104125  
2009-02           78.589445                    60.072025  

Merging...
...finished!

Exporting ensemble predictions to csv file...
Exporting full predictions to csv file...
...finished!

[Time elapsed: 01m 13s]


==============================================================
== Pipeline Step 4: Ranking Models' Predictive Performance ==
==============================================================

Calculating MAE, RMSE, MAPE, sMAPE per model...
Ranking forecasters ...
...finished!

Exporting metrics ranking to csv file...
...finished!

Results:
                                          Model        MAE       RMSE  \
0                     Weighted Ensemble: Simple   1.961156   2.594782   
1           Weighted Ensemble: Inverse Variance   1.966691   2.595708   
2               Weighted Ensemble: Inverse RMSE   1.962414   2.578586   
3                         Exponential Smoothing   2.059355   2.667917   
4                                    AutoSARIMA   2.087225   2.688896   
5                                         Naive   2.094541   2.717243   
6                                 Naive (drift)   2.121582   2.717872   
7                   Meta Ensemble: RandomForest   2.194736   2.771463   
8                          Meta Ensemble: Ridge   2.216565   2.882020   
9   Weighted Ensemble: Inverse Error Covariance   2.233037   2.958330   
10                      XGBoost with covariates   2.322688   3.146786   
11                           Meta Ensemble: SVR   2.320089   2.969596   
12                                      XGBoost   2.313007   3.070661   
13             Meta Ensemble: Linear Regression   2.361680   3.106995   
14                                          STL   3.435032   4.510927   
15                           Meta Ensemble: MLP  12.996535  15.284381   

        MAPE      sMAPE  MAE Ranking  RMSE Ranking  MAPE Ranking  \
0   0.027420   1.839140            1             2             1   
1   0.027491   1.844966            3             3             2   
2   0.027491   1.843975            2             1             3   
3   0.028848   1.933606            4             4             4   
4   0.029154   1.952686            5             5             5   
5   0.029453   1.972192            6             6             6   
6   0.029849   1.994633            7             7             7   
7   0.030667   2.057694            8             8             8   
8   0.031265   2.087496            9             9             9   
9   0.031425   2.103188           10            10            10   
10  0.032399   2.188361           13            14            11   
11  0.032986   2.198613           12            11            12   
12  0.033173   2.244724           11            12            13   
13  0.033410   2.247111           14            13            14   
14  0.048180   3.200819           15            15            15   
15  0.183987  11.336418           16            16            16   

    sMAPE Ranking  
0               1  
1               3  
2               2  
3               4  
4               5  
5               6  
6               7  
7               8  
8               9  
9              10  
10             11  
11             12  
12             13  
13             14  
14             15  
15             16  


[2024-03-07 03:04] Finished Pipeline!
[Total time elapsed: 01m 13s]
=================================================================================
