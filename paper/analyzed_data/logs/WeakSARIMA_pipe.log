
=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
Dates found in 'index' column!
Inferred frequency: month start
Data goes from 2004-01 to 2023-12, resulting in 240 observations.

Selecting target and covariates...
Target: WeakSARIMA
Covariates: None

Data Insights:
         WeakSARIMA
Date               
2004-01   67.834583
2004-02   67.990248
2004-03   60.532925
2004-04   60.827498
2004-05   57.793300

[Time elapsed: 14m 32s]


=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data for training of forecasters (train/test ratio: 30/70)...
Initial training set has 72 observations and goes from 2004-01 to 2009-12.

In an historical expanding window approach, there are 168 periods to be forecasted by the individual models: 2010-01 to 2023-12
Out-of-sample predictions are generated for next period: 2024-01

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (drift) (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMA (sktime)
Auto-fitting model. Refitting every 56th period.
...forecast 1 / 168
...forecast 42 / 168
...forecast 84 / 168
...forecast 126 / 168
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Exponential Smoothing (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: STL (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: XGBoost (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Skipping covariate forecasters since no covariates are given.

Finished predictions of individual forecasters!

Insights into forecasters' historical predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2010-01  54.125598      53.932514   53.419395              53.144189   
2010-02  54.391598      54.204890   55.400318              54.186541   
2010-03  55.414677      55.244541   54.473555              55.208567   
2010-04  57.505825      57.366247   56.715515              57.130932   
2010-05  54.400890      54.221774   54.307201              54.870874   

               STL    XGBoost  
Date                           
2010-01  54.909797  53.260006  
2010-02  59.503070  49.700474  
2010-03  54.191112  53.145664  
2010-04  52.546657  56.468643  
2010-05  50.757380  49.862255  

Insights into forecasters' future predictions:
           Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing        STL  \
Date                                                                            
2024-01  80.9192      80.973948      81.193              80.447976  83.754654   

           XGBoost  
Date                
2024-01  82.660751  

[Time elapsed: 18m 47s]


===================================================
== Pipeline Step 3: Ensemble Models' Predictions ==
===================================================

Splitting individual forecast data (n = 168) for training of ensemblers (train/test ratio: 25/75)...
Initial training set has 42 observations and goes from 2010-01 to 2013-06

In an historical expanding window approach, there are 126 periods to be forecasted by the ensemble models: 2013-07 to 2023-12
Out-of-sample predictions are generated for next period: 2023-12-31 00:00:00

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Simple'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse RMSE'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Variance'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Error Covariance'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - SVR (sklearn)'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Random Forest (sklearn)'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Finished predictions of ensemble forecasters!

Insights into ensemblers' historical predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
2013-07                  67.427715                        67.483178   
2013-08                  64.236304                        64.404621   
2013-09                  65.396939                        65.376401   
2013-10                  60.345122                        60.493217   
2013-11                  59.294252                        59.307259   

         Weighted Ensemble: Inverse Variance  \
2013-07                            67.454341   
2013-08                            64.337087   
2013-09                            65.689422   
2013-10                            60.337495   
2013-11                            59.088977   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
2013-07                                    67.768302           67.174073   
2013-08                                    65.363727           65.051277   
2013-09                                    63.234037           63.299245   
2013-10                                    63.262352           64.673124   
2013-11                                    62.138762           61.305368   

         Meta Ensemble: Random Forest  
2013-07                     67.824745  
2013-08                     64.299624  
2013-09                     60.831694  
2013-10                     63.226878  
2013-11                     58.734106  

Insights into ensemblers' future predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
Date                                                                  
2024-01                  81.658256                        81.532194   

         Weighted Ensemble: Inverse Variance  \
Date                                           
2024-01                            81.602971   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
Date                                                                       
2024-01                                    81.546511           81.398278   

         Meta Ensemble: Random Forest  
Date                                   
2024-01                     82.543451  

Merging...
...finished!


[Time elapsed: 19m 13s]


==============================================================
== Pipeline Step 4: Ranking Models' Predictive Performance ==
==============================================================

Calculating MAPE, RMSE, sMAPE per model...
Ranking models ...
...finished!

Results:
                                                 MAPE      RMSE     sMAPE  \
Model                                                                       
Weighted Ensemble: Simple                    0.030278  2.644191  2.018751   
Weighted Ensemble: Inverse RMSE              0.030288  2.640407  2.018978   
Weighted Ensemble: Inverse Variance          0.030291  2.639048  2.019391   
Weighted Ensemble: Inverse Error Covariance  0.030836  2.761528  2.054576   
AutoSARIMA                                   0.031148  2.710313  2.073020   
Exponential Smoothing                        0.032660  2.781677  2.174801   
Meta Ensemble: SVR                           0.032751  2.972857  2.190514   
Naive                                        0.032951  2.791199  2.194743   
Naive (drift)                                0.033013  2.798546  2.198737   
XGBoost                                      0.034701  3.180757  2.328224   
Meta Ensemble: Random Forest                 0.035416  3.191925  2.368959   
STL                                          0.044823  3.999710  2.979882   

                                             MAPE Ranking  RMSE Ranking  \
Model                                                                     
Weighted Ensemble: Simple                               1             3   
Weighted Ensemble: Inverse RMSE                         2             2   
Weighted Ensemble: Inverse Variance                     3             1   
Weighted Ensemble: Inverse Error Covariance             4             5   
AutoSARIMA                                              5             4   
Exponential Smoothing                                   6             6   
Meta Ensemble: SVR                                      7             9   
Naive                                                   8             7   
Naive (drift)                                           9             8   
XGBoost                                                10            10   
Meta Ensemble: Random Forest                           11            11   
STL                                                    12            12   

                                             sMAPE Ranking  
Model                                                       
Weighted Ensemble: Simple                                1  
Weighted Ensemble: Inverse RMSE                          2  
Weighted Ensemble: Inverse Variance                      3  
Weighted Ensemble: Inverse Error Covariance              4  
AutoSARIMA                                               5  
Exponential Smoothing                                    6  
Meta Ensemble: SVR                                       7  
Naive                                                    8  
Naive (drift)                                            9  
XGBoost                                                 10  
Meta Ensemble: Random Forest                            11  
STL                                                     12  

The 'Weighted Ensemble: Simple' is identified as the best model based on the MAPE value of its the historical predictions.
Thus, it is recommended to work with the future predictions coming from this model:
Date
2024-01    81.658256
Freq: M, Name: Weighted Ensemble: Simple, dtype: float64

[2024-03-10 11:46] Finished Pipeline for WeakSARIMA!
[Total time elapsed: 19m 13s]
=================================================================================

