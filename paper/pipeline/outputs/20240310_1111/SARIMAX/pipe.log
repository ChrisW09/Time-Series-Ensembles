
=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
Dates found in 'index' column!
Inferred frequency: month start
Data goes from 2004-01 to 2010-12, resulting in 84 observations.

Selecting target and covariates...
Target: SARIMAX
Covariates: x1, x2, x3

Data Insights:
           SARIMAX          x1         x2          x3
Date                                                 
2004-01  63.359514  323.949027  40.000000  933.107000
2004-02  62.756503  308.988281  49.263525  934.755444
2004-03  58.479650  302.057244  46.104072  932.751264
2004-04  56.888113  293.210459  47.277415  930.060213
2004-05  56.145492  299.166454  44.259856  930.273192

[Time elapsed: 00s]


=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data for training of forecasters (train/test ratio: 30/70)...
Initial training set has 26 observations and goes from 2004-01 to 2006-02.

In an historical expanding window approach, there are 58 periods to be forecasted by the individual models: 2006-03 to 2010-12
Out-of-sample predictions are generated for next period: 2011-01

Now generating 58 one-step ahead historical expanding window predictions from model: Naive (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 58 one-step ahead historical expanding window predictions from model: AutoSARIMAX with covariates (sktime)
Auto-fitting model. Refitting every 20th period.
...forecast 1 / 58
...forecast 15 / 58
...forecast 29 / 58
...forecast 44 / 58
Performing out-of-sample predictions...
...finished!

Finished predictions of individual forecasters!

Insights into forecasters' historical predictions:
             Naive  AutoSARIMAX with covariates
Date                                           
2006-03  66.458287                    57.803186
2006-04  66.861240                    60.014335
2006-05  67.937728                    56.966578
2006-06  64.907253                    65.785600
2006-07  61.286462                    64.171909

Insights into forecasters' future predictions:
             Naive  AutoSARIMAX with covariates
Date                                           
2011-01  53.867184                    53.446339

[Time elapsed: 54s]


===================================================
== Pipeline Step 3: Ensemble Models' Predictions ==
===================================================

Splitting individual forecast data (n = 58) for training of ensemblers (train/test ratio: 25/75)...
Initial training set has 15 observations and goes from 2006-03 to 2007-05

In an historical expanding window approach, there are 43 periods to be forecasted by the ensemble models: 2007-06 to 2010-12
Out-of-sample predictions are generated for next period: 2010-12-31 00:00:00

Now generating 43 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Simple'
...Forecast 1 / 43
...Forecast 11 / 43
...Forecast 22 / 43
...Forecast 33 / 43
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 43 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse RMSE'
...Forecast 1 / 43
...Forecast 11 / 43
...Forecast 22 / 43
...Forecast 33 / 43
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 43 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Variance'
...Forecast 1 / 43
...Forecast 11 / 43
...Forecast 22 / 43
...Forecast 33 / 43
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 43 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Error Covariance'
...Forecast 1 / 43
...Forecast 11 / 43
...Forecast 22 / 43
...Forecast 33 / 43
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 43 one-step ahead historical expanding window predictions from ensemble model: 'Meta - SVR (sklearn)'
...Forecast 1 / 43
...Forecast 11 / 43
...Forecast 22 / 43
...Forecast 33 / 43
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 43 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Random Forest (sklearn)'
...Forecast 1 / 43
...Forecast 11 / 43
...Forecast 22 / 43
...Forecast 33 / 43
...finished!
Performing out-of-sample predictions...
...finished!

Finished predictions of ensemble forecasters!

Insights into ensemblers' historical predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
2007-06                  56.582249                        55.880391   
2007-07                  57.847388                        56.972508   
2007-08                  56.969464                        56.713334   
2007-09                  59.525276                        58.403343   
2007-10                  52.695259                        52.190662   

         Weighted Ensemble: Inverse Variance  \
2007-06                            56.460271   
2007-07                            57.842442   
2007-08                            56.994928   
2007-09                            59.675074   
2007-10                            52.767902   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
2007-06                                    54.397466           56.167177   
2007-07                                    55.218616           55.277040   
2007-08                                    56.232812           57.250597   
2007-09                                    56.313478           55.345453   
2007-10                                    51.171710           54.068822   

         Meta Ensemble: Random Forest  
2007-06                     55.091904  
2007-07                     54.209274  
2007-08                     54.907818  
2007-09                     54.822537  
2007-10                     58.013975  

Insights into ensemblers' future predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
Date                                                                  
2011-01                  53.656762                        53.702698   

         Weighted Ensemble: Inverse Variance  \
Date                                           
2011-01                            53.659808   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
Date                                                                       
2011-01                                    53.881087           54.159621   

         Meta Ensemble: Random Forest  
Date                                   
2011-01                     56.353169  

Merging...
...finished!


[Time elapsed: 01m 02s]


==============================================================
== Pipeline Step 4: Ranking Models' Predictive Performance ==
==============================================================

Calculating MAPE, RMSE, sMAPE per model...
Ranking models ...
...finished!

Results:
                                                 MAPE      RMSE     sMAPE  \
Model                                                                       
Naive                                        0.050100  2.796473  3.325733   
Weighted Ensemble: Inverse Error Covariance  0.050146  2.805445  3.328174   
Meta Ensemble: SVR                           0.052177  3.097987  3.405746   
Weighted Ensemble: Inverse RMSE              0.052504  2.973408  3.480482   
Weighted Ensemble: Simple                    0.054323  3.091256  3.597819   
Weighted Ensemble: Inverse Variance          0.054400  3.102730  3.602595   
AutoSARIMAX with covariates                  0.060995  3.589725  4.023632   
Meta Ensemble: Random Forest                 0.062650  3.657346  4.115971   

                                             MAPE Ranking  RMSE Ranking  \
Model                                                                     
Naive                                                   1             1   
Weighted Ensemble: Inverse Error Covariance             2             2   
Meta Ensemble: SVR                                      3             5   
Weighted Ensemble: Inverse RMSE                         4             3   
Weighted Ensemble: Simple                               5             4   
Weighted Ensemble: Inverse Variance                     6             6   
AutoSARIMAX with covariates                             7             7   
Meta Ensemble: Random Forest                            8             8   

                                             sMAPE Ranking  
Model                                                       
Naive                                                    1  
Weighted Ensemble: Inverse Error Covariance              2  
Meta Ensemble: SVR                                       3  
Weighted Ensemble: Inverse RMSE                          4  
Weighted Ensemble: Simple                                5  
Weighted Ensemble: Inverse Variance                      6  
AutoSARIMAX with covariates                              7  
Meta Ensemble: Random Forest                             8  

The 'Naive' is identified as the best model based on the MAPE value of its the historical predictions.
Thus, it is recommended to work with the future predictions coming from this model:
Date
2011-01    53.867184
Freq: M, Name: Naive, dtype: float64

[2024-03-10 11:12] Finished Pipeline for SARIMAX!
[Total time elapsed: 01m 02s]
=================================================================================

