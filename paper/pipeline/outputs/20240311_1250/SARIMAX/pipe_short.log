=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
Dates found in 'index' column!
Inferred frequency: month start
Data goes from 2004-01 to 2023-12, resulting in 240 observations.

Selecting target and covariates...
Target: Simulated SARIMAX
Covariates: x1, x2, x3

Data Insights:
           SARIMAX          x1         x2          x3
Date                                                 
2004-01  63.359514  323.949027  40.000000  933.107000
2004-02  62.756503  308.988281  49.263525  934.755444
2004-03  58.479650  302.057244  46.104072  932.751264
2004-04  56.888113  293.210459  47.277415  930.060213
2004-05  56.145492  299.166454  44.259856  930.273192



=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data for training of forecasters (train/test ratio: 30/70)...
Initial training set has 72 observations and goes from 2004-01 to 2009-12.

In an historical expanding window approach, there are 168 periods to be forecasted by the individual models: 2010-01 to 2023-12
Out-of-sample predictions are generated for next period: 2024-01

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoTheta (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMA (sktime)
Auto-fitting model. Refitting every 26th period.
...forecast 1 / 168 done
...forecast 42 / 168 done
...forecast 84 / 168 done
...forecast 126 / 168 done
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Exponential Smoothing (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: TiDE (darts)
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: STL (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: XGBoost (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMAX with covariates (sktime)
Auto-fitting model. Refitting every 26th period.
...forecast 1 / 168 done
...forecast 42 / 168 done
...forecast 84 / 168 done
...forecast 126 / 168 done
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: XGBoostCov with covariates (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Finished predictions of individual forecasters!

Insights into forecasters' historical predictions:
             Naive  AutoTheta  AutoSARIMA  Exponential Smoothing       TiDE  \
Date                                                                          
2010-01  48.313254  47.025734   47.771970              48.786768  44.468848   
2010-02  49.046896  48.413158   47.772631              49.239971  46.522836   
2010-03  46.196081  46.908203   46.568857              46.677178  46.031154   
2010-04  47.743744  47.470715   47.979396              47.125791  45.128521   
2010-05  46.389321  46.739136   46.342559              46.254855  46.174442   

               STL    XGBoost  AutoSARIMAX with covariates  \
Date                                                         
2010-01  49.831533  45.596222                    47.389202   
2010-02  49.402094  45.476078                    49.038899   
2010-03  45.191216  43.880276                    46.468055   
2010-04  46.595300  46.005119                    47.504141   
2010-05  49.016185  45.911194                    46.358433   

         XGBoostCov with covariates  
Date                                 
2010-01                   44.591103  
2010-02                   45.575645  
2010-03                   46.436844  
2010-04                   46.572884  
2010-05                   47.536079  

Insights into forecasters' future predictions:
             Naive  AutoTheta  AutoSARIMA  Exponential Smoothing      TiDE  \
Date                                                                         
2024-01  78.144651  79.071466   77.515352              78.915751  73.43967   

               STL    XGBoost  AutoSARIMAX with covariates  \
Date                                                         
2024-01  81.860428  76.515747                     77.59309   

         XGBoostCov with covariates  
Date                                 
2024-01                   75.235245  



===================================================
== Pipeline Step 3: Ensemble Models' Predictions ==
===================================================

Splitting individual forecast data (n = 168) for training of ensemblers (train/test ratio: 25/75)...
Initial training set has 42 observations and goes from 2010-01 to 2013-06

In an historical expanding window approach, there are 126 periods to be forecasted by the ensemble models: 2013-07 to 2023-12
Out-of-sample predictions are generated for next period: 2023-12-31 00:00:00

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Simple'
...Forecast 1 / 126 done
...Forecast 32 / 126 done
...Forecast 63 / 126 done
...Forecast 95 / 126 done
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse RMSE'
...Forecast 1 / 126 done
...Forecast 32 / 126 done
...Forecast 63 / 126 done
...Forecast 95 / 126 done
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Variance'
...Forecast 1 / 126 done
...Forecast 32 / 126 done
...Forecast 63 / 126 done
...Forecast 95 / 126 done
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Error Covariance'
...Forecast 1 / 126 done
...Forecast 32 / 126 done
...Forecast 63 / 126 done
...Forecast 95 / 126 done
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - SVR (sklearn)'
...Forecast 1 / 126 done
...Forecast 32 / 126 done
...Forecast 63 / 126 done
...Forecast 95 / 126 done
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Random Forest (sklearn)'
...Forecast 1 / 126 done
...Forecast 32 / 126 done
...Forecast 63 / 126 done
...Forecast 95 / 126 done
...finished!
Performing out-of-sample predictions...
...finished!

Finished predictions of ensemble forecasters!

Insights into ensemblers' historical predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
2013-07                  74.140877                        74.191902   
2013-08                  72.260242                        72.269813   
2013-09                  72.106384                        72.026578   
2013-10                  67.144222                        67.309062   
2013-11                  67.318831                        67.316255   

         Weighted Ensemble: Inverse Variance  \
2013-07                            74.131504   
2013-08                            72.305384   
2013-09                            72.136507   
2013-10                            67.195474   
2013-11                            67.339337   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
2013-07                                    74.502571           75.118059   
2013-08                                    72.771572           73.051011   
2013-09                                    71.470104           71.459038   
2013-10                                    67.653562           65.799589   
2013-11                                    69.728023           70.981921   

         Meta Ensemble: Random Forest  
2013-07                     73.923207  
2013-08                     73.033939  
2013-09                     72.707085  
2013-10                     68.287689  
2013-11                     68.032331  

Insights into ensemblers' future predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
Date                                                                  
2024-01                  77.587933                        77.596913   

         Weighted Ensemble: Inverse Variance  \
Date                                           
2024-01                            77.579587   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
Date                                                                       
2024-01                                    77.380287           77.378538   

         Meta Ensemble: Random Forest  
Date                                   
2024-01                     76.811108  

Merging...
...finished!


==============================================================
== Pipeline Step 4: Ranking Models' Predictive Performance ==
==============================================================

Calculating MAPE, RMSE, sMAPE per model...
Ranking models ...
...finished!

Results:
                                                 MAPE      RMSE     sMAPE  \
Model                                                                       
Weighted Ensemble: Inverse RMSE              0.027950  2.652159  1.863528   
AutoSARIMAX with covariates                  0.027973  2.613503  1.863506   
Weighted Ensemble: Inverse Variance          0.028044  2.663745  1.870505   
Weighted Ensemble: Simple                    0.028066  2.669684  1.871952   
AutoSARIMA                                   0.028086  2.655436  1.870248   
Naive                                        0.028448  2.736189  1.893638   
Exponential Smoothing                        0.028871  2.719176  1.919730   
AutoTheta                                    0.029765  2.788908  1.981329   
Weighted Ensemble: Inverse Error Covariance  0.029933  2.849370  1.993154   
TiDE                                         0.030370  3.043809  2.019368   
Meta Ensemble: Random Forest                 0.030684  2.861621  2.049118   
Meta Ensemble: SVR                           0.030830  2.919524  2.050512   
XGBoostCov with covariates                   0.035543  3.452591  2.388076   
XGBoost                                      0.036741  3.554502  2.471411   
STL                                          0.044035  4.202281  2.928100   

                                             MAPE Ranking  RMSE Ranking  \
Model                                                                     
Weighted Ensemble: Inverse RMSE                         1             2   
AutoSARIMAX with covariates                             2             1   
Weighted Ensemble: Inverse Variance                     3             4   
Weighted Ensemble: Simple                               4             5   
AutoSARIMA                                              5             3   
Naive                                                   6             7   
Exponential Smoothing                                   7             6   
AutoTheta                                               8             8   
Weighted Ensemble: Inverse Error Covariance             9             9   
TiDE                                                   10            12   
Meta Ensemble: Random Forest                           11            10   
Meta Ensemble: SVR                                     12            11   
XGBoostCov with covariates                             13            13   
XGBoost                                                14            14   
STL                                                    15            15   

                                             sMAPE Ranking  
Model                                                       
Weighted Ensemble: Inverse RMSE                          2  
AutoSARIMAX with covariates                              1  
Weighted Ensemble: Inverse Variance                      4  
Weighted Ensemble: Simple                                5  
AutoSARIMA                                               3  
Naive                                                    6  
Exponential Smoothing                                    7  
AutoTheta                                                8  
Weighted Ensemble: Inverse Error Covariance              9  
TiDE                                                    10  
Meta Ensemble: Random Forest                            11  
Meta Ensemble: SVR                                      12  
XGBoostCov with covariates                              13  
XGBoost                                                 14  
STL                                                     15  

The 'Weighted Ensemble: Inverse RMSE' is identified as the best model based on the MAPE value of its the historical predictions.
Thus, it is recommended to work with the future predictions coming from this model:
Date
2024-01    77.596913
Freq: M, Name: Weighted Ensemble: Inverse RMSE, dtype: float64

[2024-03-11 13:03] Finished Pipeline for SARIMAX dataset!
[Total time elapsed: 12m 40s]
=================================================================================