
=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
Dates found in 'index' column!
Inferred frequency: month start
Data goes from 2004-01 to 2023-12, resulting in 240 observations.

Selecting target and covariates...
Target: SARIMAX
Covariates: x1, x2, x3

Data Insights:
           SARIMAX          x1         x2          x3
Date                                                 
2004-01  63.359514  323.949027  40.000000  933.107000
2004-02  62.756503  308.988281  49.263525  934.755444
2004-03  58.479650  302.057244  46.104072  932.751264
2004-04  56.888113  293.210459  47.277415  930.060213
2004-05  56.145492  299.166454  44.259856  930.273192

[Time elapsed: 00s]


=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data for training of forecasters (train/test ratio: 30/70)...
Initial training set has 72 observations and goes from 2004-01 to 2009-12.

In an historical expanding window approach, there are 168 periods to be forecasted by the individual models: 2010-01 to 2023-12
Out-of-sample predictions are generated for next period: 2024-01

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (drift) (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMA (sktime)
Auto-fitting model. Refitting every 56th period.
...forecast 1 / 168
...forecast 42 / 168
...forecast 84 / 168
...forecast 126 / 168
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Exponential Smoothing (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: STL (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: XGBoost (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMAX with covariates (sktime)
Auto-fitting model. Refitting every 56th period.
...forecast 1 / 168
...forecast 42 / 168
...forecast 84 / 168
...forecast 126 / 168
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: XGBoostCov with covariates (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Finished predictions of individual forecasters!

Insights into forecasters' historical predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2010-01  48.313254      48.101335   47.771970              47.123553   
2010-02  49.046896      48.848110   47.772631              48.516415   
2010-03  46.196081      45.960966   46.568857              46.861363   
2010-04  47.743744      47.532720   47.979396              47.486704   
2010-05  46.389321      46.163052   46.342559              46.710771   

               STL    XGBoost  AutoSARIMAX with covariates  \
Date                                                         
2010-01  49.831533  45.596222                    47.389202   
2010-02  49.402094  45.476078                    49.038899   
2010-03  45.191216  43.880276                    46.468055   
2010-04  46.595300  46.005119                    47.504141   
2010-05  49.016185  45.911194                    46.358433   

         XGBoostCov with covariates  
Date                                 
2010-01                   44.591103  
2010-02                   45.575645  
2010-03                   46.436844  
2010-04                   46.572884  
2010-05                   47.536079  

Insights into forecasters' future predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2024-01  78.144651      78.206514   77.515352              77.551955   

               STL    XGBoost  AutoSARIMAX with covariates  \
Date                                                         
2024-01  81.860428  76.515747                     77.59309   

         XGBoostCov with covariates  
Date                                 
2024-01                   75.235245  

[Time elapsed: 04m 15s]


===================================================
== Pipeline Step 3: Ensemble Models' Predictions ==
===================================================

Splitting individual forecast data (n = 168) for training of ensemblers (train/test ratio: 25/75)...
Initial training set has 42 observations and goes from 2010-01 to 2013-06

In an historical expanding window approach, there are 126 periods to be forecasted by the ensemble models: 2013-07 to 2023-12
Out-of-sample predictions are generated for next period: 2023-12-31 00:00:00

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Simple'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse RMSE'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Variance'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Error Covariance'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - SVR (sklearn)'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Random Forest (sklearn)'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Finished predictions of ensemble forecasters!

Insights into ensemblers' historical predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
2013-07                  74.422512                        74.434981   
2013-08                  72.006030                        72.018029   
2013-09                  72.052187                        72.048192   
2013-10                  66.443187                        66.761167   
2013-11                  66.602923                        66.660773   

         Weighted Ensemble: Inverse Variance  \
2013-07                            74.430002   
2013-08                            72.052484   
2013-09                            72.066391   
2013-10                            66.479013   
2013-11                            66.632824   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
2013-07                                    74.645783           75.411581   
2013-08                                    71.985872           72.675576   
2013-09                                    71.181467           71.221115   
2013-10                                    68.470624           69.358529   
2013-11                                    68.231758           69.224260   

         Meta Ensemble: Random Forest  
2013-07                     73.772870  
2013-08                     73.013435  
2013-09                     72.825795  
2013-10                     68.291113  
2013-11                     68.086048  

Insights into ensemblers' future predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
Date                                                                  
2024-01                  77.827873                        77.770487   

         Weighted Ensemble: Inverse Variance  \
Date                                           
2024-01                            77.778476   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
Date                                                                       
2024-01                                    77.559678           78.254318   

         Meta Ensemble: Random Forest  
Date                                   
2024-01                     77.722661  

Merging...
...finished!


[Time elapsed: 04m 46s]


==============================================================
== Pipeline Step 4: Ranking Models' Predictive Performance ==
==============================================================

Calculating MAPE, RMSE, sMAPE per model...
Ranking models ...
...finished!

Results:
                                                 MAPE      RMSE     sMAPE  \
Model                                                                       
AutoSARIMAX with covariates                  0.027804  2.609629  1.851953   
Exponential Smoothing                        0.027810  2.641907  1.852290   
Weighted Ensemble: Inverse RMSE              0.027878  2.674183  1.859397   
AutoSARIMA                                   0.028050  2.678018  1.867650   
Weighted Ensemble: Inverse Variance          0.028060  2.688731  1.872210   
Weighted Ensemble: Simple                    0.028116  2.694168  1.876010   
Naive (drift)                                0.028447  2.745195  1.892511   
Naive                                        0.028448  2.736189  1.893638   
Weighted Ensemble: Inverse Error Covariance  0.029482  2.774587  1.969228   
Meta Ensemble: SVR                           0.029712  2.772377  1.976255   
Meta Ensemble: Random Forest                 0.030461  2.911041  2.035554   
XGBoostCov with covariates                   0.035543  3.452591  2.388076   
XGBoost                                      0.036741  3.554502  2.471411   
STL                                          0.044035  4.202281  2.928100   

                                             MAPE Ranking  RMSE Ranking  \
Model                                                                     
AutoSARIMAX with covariates                             1             1   
Exponential Smoothing                                   2             2   
Weighted Ensemble: Inverse RMSE                         3             3   
AutoSARIMA                                              4             4   
Weighted Ensemble: Inverse Variance                     5             5   
Weighted Ensemble: Simple                               6             6   
Naive (drift)                                           7             8   
Naive                                                   8             7   
Weighted Ensemble: Inverse Error Covariance             9            10   
Meta Ensemble: SVR                                     10             9   
Meta Ensemble: Random Forest                           11            11   
XGBoostCov with covariates                             12            12   
XGBoost                                                13            13   
STL                                                    14            14   

                                             sMAPE Ranking  
Model                                                       
AutoSARIMAX with covariates                              1  
Exponential Smoothing                                    2  
Weighted Ensemble: Inverse RMSE                          3  
AutoSARIMA                                               4  
Weighted Ensemble: Inverse Variance                      5  
Weighted Ensemble: Simple                                6  
Naive (drift)                                            7  
Naive                                                    8  
Weighted Ensemble: Inverse Error Covariance              9  
Meta Ensemble: SVR                                      10  
Meta Ensemble: Random Forest                            11  
XGBoostCov with covariates                              12  
XGBoost                                                 13  
STL                                                     14  

The 'AutoSARIMAX with covariates' is identified as the best model based on the MAPE value of its the historical predictions.
Thus, it is recommended to work with the future predictions coming from this model:
Date
2024-01    77.59309
Freq: M, Name: AutoSARIMAX with covariates, dtype: float64

[2024-03-10 11:21] Finished Pipeline for SARIMAX!
[Total time elapsed: 04m 46s]
=================================================================================

