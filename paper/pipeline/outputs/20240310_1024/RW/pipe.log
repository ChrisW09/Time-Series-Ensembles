
=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
Dates found in 'index' column!
Inferred frequency: month start
Data goes from 2004-01 to 2023-12, resulting in 240 observations.

Selecting target and covariates...
Target: RW
Covariates: None

Data Insights:
                RW
Date              
2004-01  75.088420
2004-02  72.932225
2004-03  60.153464
2004-04  57.815302
2004-05  54.129793

[Time elapsed: 00s]


=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data for training of forecasters (train/test ratio: 30/70)...
Initial training set has 72 observations and goes from 2004-01 to 2009-12.

In an historical expanding window approach, there are 168 periods to be forecasted by the individual models: 2010-01 to 2023-12
Out-of-sample predictions are generated for next period: 2024-01

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (drift) (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMA (sktime)
Auto-fitting model. Refitting every 56th period.
...forecast 1 / 168
...forecast 42 / 168
...forecast 84 / 168
...forecast 126 / 168
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Exponential Smoothing (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: STL (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: XGBoost (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Skipping covariate forecasters since no covariates are given.

Finished predictions of individual forecasters!

Insights into forecasters' historical predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2010-01  70.357763      70.291134   67.189219              67.144519   
2010-02  65.175493      65.037813   65.985962              65.983865   
2010-03  66.332539      66.212595   66.177140              66.185763   
2010-04  72.617072      72.583675   69.820543              69.924004   
2010-05  67.298885      67.195025   68.393410              68.396556   

               STL    XGBoost  
Date                           
2010-01  68.486965  67.024727  
2010-02  74.402336  66.466400  
2010-03  64.393948  66.864151  
2010-04  66.526448  69.103317  
2010-05  65.048765  67.141479  

Insights into forecasters' future predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2024-01  69.637634      69.614828   67.153181              67.819906   

               STL    XGBoost  
Date                           
2024-01  72.714918  68.841316  

[Time elapsed: 01m 37s]


===================================================
== Pipeline Step 3: Ensemble Models' Predictions ==
===================================================

Splitting individual forecast data (n = 168) for training of ensemblers (train/test ratio: 25/75)...
Initial training set has 42 observations and goes from 2010-01 to 2013-06

In an historical expanding window approach, there are 126 periods to be forecasted by the ensemble models: 2013-07 to 2023-12
Out-of-sample predictions are generated for next period: 2023-12-31 00:00:00

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Simple'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse RMSE'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Variance'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Error Covariance'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - SVR (sklearn)'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 126 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Random Forest (sklearn)'
...Forecast 1 / 126
...Forecast 32 / 126
...Forecast 63 / 126
...Forecast 95 / 126
...finished!
Performing out-of-sample predictions...
...finished!

Finished predictions of ensemble forecasters!

Insights into ensemblers' historical predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
2013-07                  67.365119                        67.430140   
2013-08                  63.746595                        63.720050   
2013-09                  67.616831                        67.589755   
2013-10                  63.049814                        62.964297   
2013-11                  60.552412                        60.334395   

         Weighted Ensemble: Inverse Variance  \
2013-07                            67.465888   
2013-08                            63.824023   
2013-09                            67.835965   
2013-10                            62.967263   
2013-11                            60.436466   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
2013-07                                    70.342272           67.732372   
2013-08                                    67.718613           63.206406   
2013-09                                    63.788495           62.966652   
2013-10                                    67.879414           62.262066   
2013-11                                    62.732538           57.474474   

         Meta Ensemble: Random Forest  
2013-07                     72.303125  
2013-08                     72.817423  
2013-09                     70.081604  
2013-10                     73.157815  
2013-11                     63.126299  

Insights into ensemblers' future predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
Date                                                                  
2024-01                  69.296964                         69.09335   

         Weighted Ensemble: Inverse Variance  \
Date                                           
2024-01                            69.061238   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
Date                                                                       
2024-01                                    69.425178           68.508207   

         Meta Ensemble: Random Forest  
Date                                   
2024-01                     66.976257  

Merging...
...finished!


[Time elapsed: 02m 05s]


==============================================================
== Pipeline Step 4: Ranking Models' Predictive Performance ==
==============================================================

Calculating MAPE, RMSE, sMAPE per model...
Ranking models ...
...finished!

Results:
                                                 MAPE      RMSE     sMAPE  \
Model                                                                       
Weighted Ensemble: Inverse Variance          0.055518  4.906257  3.678652   
Weighted Ensemble: Inverse RMSE              0.055839  4.924158  3.699730   
Weighted Ensemble: Simple                    0.056098  4.954370  3.717265   
AutoSARIMA                                   0.057057  4.965778  3.775760   
Exponential Smoothing                        0.057065  4.967759  3.776259   
Naive                                        0.059176  5.149567  3.925315   
Naive (drift)                                0.059342  5.165420  3.938057   
Weighted Ensemble: Inverse Error Covariance  0.061030  5.250322  4.022200   
Meta Ensemble: SVR                           0.061396  5.223736  4.057004   
XGBoost                                      0.062959  5.521640  4.181000   
Meta Ensemble: Random Forest                 0.065678  5.707461  4.342373   
STL                                          0.092567  7.961270  6.151185   

                                             MAPE Ranking  RMSE Ranking  \
Model                                                                     
Weighted Ensemble: Inverse Variance                     1             1   
Weighted Ensemble: Inverse RMSE                         2             2   
Weighted Ensemble: Simple                               3             3   
AutoSARIMA                                              4             4   
Exponential Smoothing                                   5             5   
Naive                                                   6             6   
Naive (drift)                                           7             7   
Weighted Ensemble: Inverse Error Covariance             8             9   
Meta Ensemble: SVR                                      9             8   
XGBoost                                                10            10   
Meta Ensemble: Random Forest                           11            11   
STL                                                    12            12   

                                             sMAPE Ranking  
Model                                                       
Weighted Ensemble: Inverse Variance                      1  
Weighted Ensemble: Inverse RMSE                          2  
Weighted Ensemble: Simple                                3  
AutoSARIMA                                               4  
Exponential Smoothing                                    5  
Naive                                                    6  
Naive (drift)                                            7  
Weighted Ensemble: Inverse Error Covariance              8  
Meta Ensemble: SVR                                       9  
XGBoost                                                 10  
Meta Ensemble: Random Forest                            11  
STL                                                     12  

The 'Weighted Ensemble: Inverse Variance' is identified as the best model based on the MAPE value of its the historical predictions.
Thus, it is recommended to work with the future predictions coming from this model:
Date
2024-01    69.061238
Freq: M, Name: Weighted Ensemble: Inverse Variance, dtype: float64

[2024-03-10 10:26] Finished Pipeline for RW!
[Total time elapsed: 02m 05s]
=================================================================================

=================================================================================
[2024-03-10 10:24] Starting  Pipeline for SARIMAX...

=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
Dates found in 'index' column!
Inferred frequency: month start
Data goes from 2004-01 to 2023-12, resulting in 240 observations.

Selecting target and covariates...
Target: SARIMAX
Covariates: x1, x2, x3

Data Insights:
           SARIMAX          x1         x2          x3
Date                                                 
2004-01  63.359514  323.949027  40.000000  933.107000
2004-02  62.756503  308.988281  49.263525  934.755444
2004-03  58.479650  302.057244  46.104072  932.751264
2004-04  56.888113  293.210459  47.277415  930.060213
2004-05  56.145492  299.166454  44.259856  930.273192

[Time elapsed: 02m 05s]


=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data for training of forecasters (train/test ratio: 30/70)...
Initial training set has 72 observations and goes from 2004-01 to 2009-12.

In an historical expanding window approach, there are 168 periods to be forecasted by the individual models: 2010-01 to 2023-12
Out-of-sample predictions are generated for next period: 2024-01

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Naive (drift) (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMA (sktime)
Auto-fitting model. Refitting every 56th period.
...forecast 1 / 168
...forecast 42 / 168
...forecast 84 / 168
...forecast 126 / 168
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: Exponential Smoothing (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: STL (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: XGBoost (darts)
Now performing corresponding out-of-sample predictions...
...finished!

Now generating 168 one-step ahead historical expanding window predictions from model: AutoSARIMAX with covariates (sktime)
Auto-fitting model. Refitting every 56th period.
...forecast 1 / 168
...forecast 42 / 168
...forecast 84 / 168
...forecast 126 / 168
Performing out-of-sample predictions...
=================================================================================
[2024-03-10 10:33] Starting  Pipeline for SARIMAX...

=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
