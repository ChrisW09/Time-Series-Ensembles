=================================================================================
[2024-03-08 09:43] Starting  Pipeline...

=========================================
== Pipeline Step 1: Data Preprocessing ==
=========================================

Searching time information...
Dates found in 'index' column!
Inferred frequency: month start
Data goes from 2004-01 to 2015-12, resulting in 144 observations.

Selecting target and covariates...
Target: y
Covariates: x1, x2, x3

Data Insights:
                 y          x1         x2          x3
Date                                                 
2004-01  50.840469  427.595799  55.337904  900.325291
2004-02  52.871538  434.062163  54.959155  900.775888
2004-03  53.769316  453.264284  56.470633  899.510058
2004-04  57.672973  459.367523  56.704233  903.524834
2004-05  57.182051  462.354356  61.557907  905.071762

[Time elapsed: 00s]


=====================================================
== Pipeline Step 2: Individual Models' Predictions ==
=====================================================

Splitting data for training of forecasters (train/test ratio: 30/70)...
Initial training set has 44 observations and goes from 2004-01 to 2007-08.

In an historical expanding window approach, there are 100 periods to be forecasted by the individual models: 2007-09 to 2015-12
Out-of-sample predictions are generated for next period: 2016-01

Now generating 100 one-step ahead historical expanding window predictions from model: Naive (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 100 one-step ahead historical expanding window predictions from model: Naive (drift) (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 100 one-step ahead historical expanding window predictions from model: AutoSARIMA (sktime)
Auto-fitting model. Refitting every 33th period.
...forecast 1 / 100
...forecast 25 / 100
...forecast 50 / 100
...forecast 75 / 100
Performing out-of-sample predictions...
...finished!

Now generating 100 one-step ahead historical expanding window predictions from model: Exponential Smoothing (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 100 one-step ahead historical expanding window predictions from model: STL (sktime)
Performing out-of-sample predictions...
...finished!

Now generating 100 one-step ahead historical expanding window predictions from model: XGBoost (darts)
Now performing corresponding out-of-sample predictions...
...finished!
Skipping with_covariates since no models are provided.

Finished predictions of individual forecasters!

Insights into forecasters' historical predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2007-09  39.396929      39.130800   41.216324              39.948088   
2007-10  43.742069      43.580742   42.315641              42.692676   
2007-11  43.020168      42.846384   43.686398              42.931328   
2007-12  47.340548      47.264462   46.583302              46.171010   
2008-01  48.280066      48.225590   49.209715              47.785350   

               STL    XGBoost  
Date                           
2007-09  45.096682  40.291088  
2007-10  42.109471  41.772690  
2007-11  45.768581  41.873455  
2007-12  44.613499  46.844360  
2008-01  42.637916  49.353115  

Insights into forecasters' future predictions:
             Naive  Naive (drift)  AutoSARIMA  Exponential Smoothing  \
Date                                                                   
2016-01  84.936483      85.174917   84.964209              84.851498   

               STL    XGBoost  
Date                           
2016-01  91.278306  84.968803  

[Time elapsed: 03m 17s]


===================================================
== Pipeline Step 3: Ensemble Models' Predictions ==
===================================================

Splitting individual forecast data (n = 100) for training of ensemblers (train/test ratio: 25/75)...
Initial training set has 25 observations and goes from 2007-09 to 2009-09

In an historical expanding window approach, there are 75 periods to be forecasted by the ensemble models: 2009-10 to 2015-12
Out-of-sample predictions are generated for next period: 2015-12-31 00:00:00

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Simple'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse RMSE'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Variance'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Weighted - Inverse Error Covariance'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Meta - SVR (sklearn)'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Ridge (sklearn)'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Linear Regression (sklearn)'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Meta - MLP (sklearn)'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Now generating 75 one-step ahead historical expanding window predictions from ensemble model: 'Meta - Random Forest (sklearn)'
...Forecast 1 / 75
...Forecast 19 / 75
...Forecast 38 / 75
...Forecast 57 / 75
...finished!
Performing out-of-sample predictions...
...finished!

Finished predictions of ensemble forecasters!

Insights into ensemblers' historical predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
2009-10                  60.309512                        60.410434   
2009-11                  60.591584                        60.299030   
2009-12                  61.999543                        61.851927   
2010-01                  60.544735                        60.271974   
2010-02                  61.353211                        61.321100   

         Weighted Ensemble: Inverse Variance  \
2009-10                            60.312001   
2009-11                            60.354677   
2009-12                            61.708747   
2010-01                            60.308058   
2010-02                            61.175722   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
2009-10                                    59.123901           60.611275   
2009-11                                    58.948999           60.227471   
2009-12                                    59.727398           61.832129   
2010-01                                    59.609583           60.161045   
2010-02                                    59.409608           61.142866   

         Meta Ensemble: Ridge  Meta Ensemble: Linear Regression  \
2009-10             60.528963                         58.872243   
2009-11             60.399068                         59.699757   
2009-12             61.346531                         59.929335   
2010-01             61.030074                         60.690040   
2010-02             60.939069                         59.575960   

         Meta Ensemble: MLP  Meta Ensemble: Random Forest  
2009-10           61.395601                     59.612707  
2009-11           70.765357                     60.138725  
2009-12           81.021246                     60.017426  
2010-01           62.355397                     61.191397  
2010-02           64.867125                     59.802752  

Insights into ensemblers' future predictions:
         Weighted Ensemble: Simple  Weighted Ensemble: Inverse RMSE  \
Date                                                                  
2016-01                  86.029036                        85.616501   

         Weighted Ensemble: Inverse Variance  \
Date                                           
2016-01                            85.903644   

         Weighted Ensemble: Inverse Error Covariance  Meta Ensemble: SVR  \
Date                                                                       
2016-01                                    83.639792           85.077433   

         Meta Ensemble: Ridge  Meta Ensemble: Linear Regression  \
Date                                                              
2016-01             85.169797                         85.626185   

         Meta Ensemble: MLP  Meta Ensemble: Random Forest  
Date                                                       
2016-01           89.167957                      84.24575  

Merging...
...finished!


Exporting historical predictions and future predictions as csv to C:\Users\Work\OneDrive\GAU\3. Semester\Statistisches Praktikum\Git\NEW_Ensemble_Techniques_TS_FC\user\outputs\noisy_simdata\20240308_0943...
...finished!

[Time elapsed: 03m 59s]


==============================================================
== Pipeline Step 4: Ranking Models' Predictive Performance ==
==============================================================

Calculating RMSE, MAPE, sMAPE per model...
Ranking models ...
...finished!

Results:
                                                  RMSE      MAPE      sMAPE  \
Model                                                                         
Weighted Ensemble: Inverse RMSE               2.811203  0.028420   1.905886   
Weighted Ensemble: Inverse Variance           2.828961  0.028457   1.908820   
Weighted Ensemble: Simple                     2.849349  0.028489   1.910962   
Exponential Smoothing                         2.837649  0.029072   1.948458   
Naive                                         2.883142  0.029242   1.957764   
Naive (drift)                                 2.882004  0.029617   1.978757   
Meta Ensemble: Ridge                          2.937377  0.029939   2.008962   
Meta Ensemble: SVR                            3.079198  0.030364   2.046130   
AutoSARIMA                                    2.883281  0.030442   2.037102   
Meta Ensemble: Linear Regression              3.046754  0.031136   2.083072   
XGBoost                                       3.342290  0.032360   2.187298   
Meta Ensemble: Random Forest                  3.351071  0.032381   2.181280   
Weighted Ensemble: Inverse Error Covariance   3.539178  0.034571   2.346372   
STL                                           4.901734  0.050245   3.360780   
Meta Ensemble: MLP                           14.989380  0.169655  10.505539   

                                             RMSE Ranking  MAPE Ranking  \
Model                                                                     
Weighted Ensemble: Inverse RMSE                         1             1   
Weighted Ensemble: Inverse Variance                     2             2   
Weighted Ensemble: Simple                               4             3   
Exponential Smoothing                                   3             4   
Naive                                                   6             5   
Naive (drift)                                           5             6   
Meta Ensemble: Ridge                                    8             7   
Meta Ensemble: SVR                                     10             8   
AutoSARIMA                                              7             9   
Meta Ensemble: Linear Regression                        9            10   
XGBoost                                                11            11   
Meta Ensemble: Random Forest                           12            12   
Weighted Ensemble: Inverse Error Covariance            13            13   
STL                                                    14            14   
Meta Ensemble: MLP                                     15            15   

                                             sMAPE Ranking  
Model                                                       
Weighted Ensemble: Inverse RMSE                          1  
Weighted Ensemble: Inverse Variance                      2  
Weighted Ensemble: Simple                                3  
Exponential Smoothing                                    4  
Naive                                                    5  
Naive (drift)                                            6  
Meta Ensemble: Ridge                                     7  
Meta Ensemble: SVR                                       9  
AutoSARIMA                                               8  
Meta Ensemble: Linear Regression                        10  
XGBoost                                                 12  
Meta Ensemble: Random Forest                            11  
Weighted Ensemble: Inverse Error Covariance             13  
STL                                                     14  
Meta Ensemble: MLP                                      15  

The 'Weighted Ensemble: Inverse RMSE' is identified as the best model based on the MAPE value of its the historical predictions.
Thus, it is recommended to work with the future predictions coming from this model:
Date
2016-01    85.616501
Freq: M, Name: Weighted Ensemble: Inverse RMSE, dtype: float64

Exporting metrics_ranking as csv to C:\Users\Work\OneDrive\GAU\3. Semester\Statistisches Praktikum\Git\NEW_Ensemble_Techniques_TS_FC\user\outputs\noisy_simdata\20240308_0943...
...finished!

[2024-03-08 09:47] Finished Pipeline!
[Total time elapsed: 03m 59s]
=================================================================================
